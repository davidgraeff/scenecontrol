PROJECT(roompulsehelper)
cmake_minimum_required(VERSION 2.6)

set(CMAKE_MODULE_PATH "${CMAKE_CURRENT_SOURCE_DIR}/cmake")
#find_package(GStreamer QUIET)
find_package(PulseAudio QUIET)
#find_package(GLIB2 REQUIRED)

OPTION(PLUGIN_${PROJECT_NAME}_EXEC "Plugin executable helper: ${PROJECT_NAME}" ON)

IF (PLUGIN_${PROJECT_NAME}_EXEC AND PULSEAUDIO_FOUND)
	IF(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT)
	  SET(CMAKE_INSTALL_PREFIX
	    "/usr" CACHE PATH "RoomMedia install prefix" FORCE
	    )
	ENDIF(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT)

	# set default build type
	IF (NOT CMAKE_BUILD_TYPE)
	  SET(CMAKE_BUILD_TYPE RelWithDebInfo CACHE STRING "Build Type")
	  SET(CMAKE_CONFIGURATION_TYPES RelWithDebInfo Release Debug CACHE STRING "")
	ENDIF (NOT CMAKE_BUILD_TYPE)

	include_directories(${GSTREAMER_INCLUDE_DIR} ${CMAKE_CURRENT_BINARY_DIR} ${PULSEAUDIO_INCLUDE_DIR})
	ADD_DEFINITIONS(-Wall -W ${GSTREAMER_DEFINITIONS})
	ADD_EXECUTABLE(${PROJECT_NAME} main.cpp)
	target_link_libraries(${PROJECT_NAME} ${GSTREAMER_LIBRARIES}
	${GSTREAMER_BASE_LIBRARY} ${GSTREAMER_INTERFACE_LIBRARY}
	${PULSEAUDIO_LIBRARY} ${PULSEAUDIO_MAINLOOP_LIBRARY} -lglib-2.0 
	)

	INSTALL(TARGETS ${PROJECT_NAME} DESTINATION bin)
ELSE()
	MESSAGE("Not building: ${PROJECT_NAME}")
ENDIF()
